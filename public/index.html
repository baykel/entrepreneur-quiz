<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>איזה יזם/ת אני?</title>

  <style>
    :root {
      --bg: #0b0c10;
      --card: #12141b;
      --muted: #a8b0c0;
      --text: #eef1f8;
      --line: rgba(255,255,255,0.12);
      --accent: #7c5cff;
      --accent2: #2ee59d;
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius: 18px;
    }

@media (max-width:480px){
  .card{ padding:28px 18px; }
  .type{ font-size:34px; }
  .desc{ font-size:16px; }
}



    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Arial;
      background: radial-gradient(1200px 800px at 70% -10%, rgba(124,92,255,0.35), transparent 60%),
                  radial-gradient(900px 700px at 10% 0%, rgba(46,229,157,0.18), transparent 55%),
                  var(--bg);
      color: var(--text);
    }

.site-logo{
  width:160px;
  height:auto;
}
@media (max-width:560px){
  .site-logo{ width:120px; }
}



    .wrap {
      max-width: 920px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    .card {
      background: rgba(18,20,27,0.85);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      overflow: hidden;
    }

    header {
      display: grid;
      gap: 10px;
      padding: 18px 18px 6px;
    }

    .title {
      font-size: 30px;
      line-height: 1.1;
      margin: 0;
      letter-spacing: -0.5px;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 15px;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 18px 6px;
    }

    .pill {
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.04);
      padding: 8px 10px;
      border-radius: 999px;
      color: var(--muted);
      font-size: 13px;
      display: inline-flex;
      gap: 8px;
      align-items: center;
      white-space: nowrap;
    }

    .progress {
      flex: 1;
      height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--line);
      overflow: hidden;
      min-width: 160px;
    }

    .progress > div {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      transition: width 220ms ease;
    }

    .quiz {
      margin-top: 10px;
      padding: 18px;
      display: grid;
      gap: 14px;
    }

    .q {
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 14px;
      background: rgba(255,255,255,0.03);
    }

    .q h3 {
      margin: 0 0 10px;
      font-size: 15px;
      color: var(--muted);
      font-weight: 600;
    }

    .q p {
      margin: 0 0 12px;
      font-size: 18px;
      letter-spacing: -0.2px;
    }

    .opts {
      display: grid;
      gap: 10px;
    }

    .opt {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(255,255,255,0.02);
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
    }

    .opt:hover {
      transform: translateY(-1px);
      border-color: rgba(124,92,255,0.5);
      background: rgba(124,92,255,0.08);
    }

    .opt.disabled {
      opacity: 0.6;
      cursor: not-allowed;
      pointer-events: none;
    }

    input[type="radio"] {
      width: 18px;
      height: 18px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    select { color: var(--text); background: rgba(255,255,255,0.02); }
    option { color: #0b0c10; background: #eef1f8; }

    .footer {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px 18px;
      border-top: 1px solid var(--line);
    }

    .footer-left{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .footer-actions{
      display:flex;
      gap:10px;
      align-items:center;
    }

    button {
      border: 0;
      border-radius: 14px;
      padding: 12px 16px;
      font-size: 15px;
      font-weight: 700;
      color: white;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(124,92,255,0.18);
      transition: transform 120ms ease, opacity 120ms ease;
      white-space: nowrap;
    }
    button:hover { transform: translateY(-1px); }

    button.secondary{
      background: rgba(255,255,255,0.08);
      border: 1px solid var(--line);
      color: var(--text);
      box-shadow: none;
    }

    button:disabled{
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .hint {
      color: var(--muted);
      font-size: 13px;
      line-height: 1.3;
    }

    .error {
      color: #ffb3b3;
      font-size: 13px;
      display: none;
    }

    /* מסכים */
    #introScreen { display: block; }
    #quizScreen { display: none; }

    .introBox{
      padding: 6px 18px 18px;
      display:grid;
      gap:14px;
    }

    .introCard{
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 16px;
      background: rgba(255,255,255,0.03);
      display:grid;
      gap:10px;
    }
.introCTA{
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:center;     /* מרכז את כל השורה */
  flex-direction: row-reverse;/* הופך את הסדר: הכפתור עובר לשמאל */
  flex-wrap:nowrap;           /* שלא ירד שורה */
  width:100%;
}


    @media (max-width: 560px) {
      /* תמונת פתיחה בתחתית מסך הפתיחה */
      .title { font-size: 26px; }
      .q p { font-size: 17px; }
      .footer { flex-direction: column; align-items: stretch; }
      .footer-actions { justify-content: stretch; }
      button { width: 100%; }
      .progress { width: 100%; }
      .topbar { flex-direction: column; align-items: stretch; }
      .pill { justify-content:center; }
    }

/* ===== SUBMIT LOADER (כמו בריסולט) ===== */
.submitBox{
  background:rgba(18,20,27,0.92);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:18px;
  padding:22px 16px;
  width:min(420px, 92vw);
  text-align:center;
  box-shadow:0 20px 60px rgba(0,0,0,0.45);
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:14px;
}

.loaderLogo{
  width:130px;
  height:auto;
  animation:float 2s ease-in-out infinite;
}

@keyframes float{
  0%{transform:translateY(0);}
  50%{transform:translateY(-10px);}
  100%{transform:translateY(0);}
}

.loaderText{
  font-size:18px;
  font-weight:800;
}

.dots span{
  width:10px;
  height:10px;
  margin:0 4px;
  background:#7c5cff;
  border-radius:50%;
  display:inline-block;
  animation:bounce 1.2s infinite ease-in-out;
}

.dots span:nth-child(2){animation-delay:.2s;}
.dots span:nth-child(3){animation-delay:.4s;}

@keyframes bounce{
  0%,80%,100%{transform:scale(0);}
  40%{transform:scale(1);}
}


/* כפתור פתיחה יותר גדול ומזמין */
#startBtn{
  padding: 16px 24px;
  font-size: 18px;
  border-radius: 16px;
  min-width: 170px;
}


/* לסדר את אזור הכפתור לשמאל (ב-RTL זה flex-start) */
.introCTA{
  justify-content: flex-start;
  width: 100%;
}

/* להרחיק קצת מהטקסט ולתת תחושה של "כפתור ראשי" */
.introCard{
  gap: 14px;
}


  </style>
</head>

<body>

  

<div id="submitOverlay" style="
  position:fixed; inset:0; display:none;
  justify-content:center; align-items:center;
  background:rgba(11,12,16,0.75);
  backdrop-filter: blur(8px);
  z-index:99999;
">
  <div class="submitBox">
    <img src="/gil-logo.png" class="loaderLogo" alt="לוגו">
    <div class="loaderText">בודקים את התוצאה שלך</div>
    <div class="dots" aria-label="loading">
      <span></span><span></span><span></span>
    </div>
  </div>


  </div>

  <img src="/gil-logo.png" class="site-logo" alt="לוגו">
  <div class="wrap">
    <div class="card">

      <header>
        <h1 class="title">איזה יזם/ת אני?</h1>
        <p class="subtitle">ענו על 10 שאלות קצרות וגלו איזה טיפוס יזמי אתם.</p>
      </header>

      <div class="topbar">
        <div class="pill" id="counter">0/10</div>
        <div class="progress" aria-label="progress">
          <div id="bar"></div>
        </div>
        <div class="pill">ניקוד לפי בחירה: 1–4</div>
      </div>

      <!-- INTRO -->
      <div id="introScreen">
        <div class="introBox">
          <div class="introCard">


            <p style="margin:0; font-size:18px;">
              זה שאלון קצר, קליל ומדויק.
            </p>
            <p style="margin:0; color:var(--muted);">
              תבחר את האופציה שהכי “אתה”, בלי לחשוב יותר מדי.
            </p>

            <div class="introCTA">
              <button id="startBtn">בואו נתחיל</button>
              <span class="hint">לוקח בערך דקה</span>
            </div>
          </div>
        </div>
      </div>

      <!-- QUIZ ONE CARD -->
      <div id="quizScreen">
        <div class="quiz">
          <div id="stepCard"></div>
        </div>

        <div class="footer">
          <div class="footer-left">
            <div class="hint" id="hintText">טיפ: תבחר את מה שהכי “אתה”, בלי לחשוב יותר מדי.</div>
            <div class="error" id="err"></div>
          </div>

          <div class="footer-actions">
            <button id="prevBtn" class="secondary">הקודם</button>
            <button id="nextBtn">הבא</button>
            <button id="submitBtn" style="display:none;">סיים וקבל תוצאה</button>
          </div>
        </div>
      </div>

    </div>
  </div>

<script>
  // ====== DATA ======
  const data = [
    { q: "כשאת מזהה בעיה בסביבה היומיומית שלך?", a: [
      "מנסה להבין מאיפה היא מגיעה",
      "חושב\\ת על רעיון חדש שיכול לשפר",
      "חושב\\ת על חיבור מול אנשים שיכולים לעזור",
      "מחפש\\ת דרך לטפל בזה מידית"
    ]},
    { q: "מה הכי מסקרן אותך?", a: [
      "להבין תהליכים",
      "לדמיין משהו חדש",
      "לעבוד עם אנשים וליצור קשרים חדשים",
      "לבצע פרויקטים ולהתקדם"
    ]},
    { q: "איך את ניגשת לפרויקט חדש", a: [
      "קורא\\ת ולומד\\ת קודם",
      "חושב\\ת על כיוונים יצירתיים",
      "מדבר\\ת עם אנשים ומחליפ\\ה רעיונות",
      "מתחיל\\ה לעשות ולומד\\ת תוך כדי"
    ]},
    { q: "איזה משפט נשמע לך מוכר", a: [
      "אני שמ\\ה לב לפרטים קטנים",
      "יש לי מלא רעיונות",
      "אני טוב\\ה בחיבורים בין אנשים",
      "אני אוהב\\ת שהדברים זזים"
    ]},
    { q: "כשמישהו מציג רעיון חדש", a: [
      "אני שואל\\ת שאלות עומק",
      "אני חושב\\ת איך אפשר לעשות את זה טוב יותר",
      "אני בודק\\ת מי יכול לעזור לו",
      "אני שואל\\ת איך הוא יבצע את זה"
    ]},
    { q: "בשעה פנויה את\\ה מעדיפ\\ה", a: [
      "לצפות במשהו מעשיר ומלמד",
      "להעלות ולפתח רעיונות חדשים",
      "לייצר שיח עם מישהו חדש שמעניין אותך",
      "לסגור משימות שדחית כבר הרבה זמן"
    ]},
    { q: "מה מבאס אותך יותר", a: [
      "בעיות שאין להן פתרון",
      "רעיונות טובים שלא באים ליידי מימוש",
      "אנשים שלא משתפים פעולה",
      "דיבורים בלי ביצוע"
    ]},
    { q: "כשיש לך משימה קשה", a: [
      "את\\ה לומדת אותה לעומק",
      "את\\ה מחפש\\ת דרך יצירתית לגשת אליה",
      "את\\ה מבקש\\ת נקודת מבט מאדם נוסף",
      "את\\ה קופצ\\ת ישר לתוך העשייה"
    ]},
    { q: "על מה את מקבלת מחמאות בדרך כלל", a: [
      "חשיבה חדה",
      "יצירתיות",
      "יכולת תקשורת",
      "יעילות בעשייה"
    ]},
    { q: "מה מהבאים הכי מתאים לך", a: [
      "אני אוהבת לפענח ולפתח",
      "אני אוהבת לחלום ולחדש",
      "אני אוהבת תקשורת ואנשים",
      "אני אוהבת שדברים קורים"
    ]}
  ];

  // ====== STATE ======
  // stepType: "details" OR "q"
  // stepIndex: -1 (intro), 0..10 where 0=details, 1..10 questions
  let stepIndex = -1;

  const answers = Array(data.length).fill(null); // 10 answers (1..4)
  let fullName = "";
  let gender = "";
  let email = "";

  // ====== ELEMENTS ======
  const introScreen = document.getElementById("introScreen");
  const quizScreen  = document.getElementById("quizScreen");
  const stepCard    = document.getElementById("stepCard");

  const counterEl = document.getElementById("counter");
  const barEl     = document.getElementById("bar");
  const errEl     = document.getElementById("err");

  const startBtn  = document.getElementById("startBtn");
  const prevBtn   = document.getElementById("prevBtn");
  const nextBtn   = document.getElementById("nextBtn");
  const submitBtn = document.getElementById("submitBtn");

  // ====== HELPERS ======
  function showError(msg){
    errEl.textContent = msg;
    errEl.style.display = "block";
  }
  function clearError(){
    errEl.textContent = "";
    errEl.style.display = "none";
  }

  function answeredCount(){
    return answers.filter(v => v !== null).length;
  }

  function updateProgress(){
    const answered = answeredCount();
    counterEl.textContent = `${answered}/10`;
    barEl.style.width = `${(answered / 10) * 100}%`;
  }

  function goToStep(newStep){
    stepIndex = newStep;
    clearError();
    renderStep();
    updateProgress();
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function currentIsDetails(){
    return stepIndex === 0;
  }

  function currentIsQuestion(){
    return stepIndex >= 1 && stepIndex <= data.length;
  }

  function currentQIndex(){
    // questions start at stepIndex=1
    return stepIndex - 1;
  }

  function isLastQuestionStep(){
    return stepIndex === data.length;
  }

  // ====== RENDER ======
  function renderStep(){
    // buttons visibility
    prevBtn.style.display = (stepIndex <= 0) ? "none" : "inline-block";
    nextBtn.style.display = "inline-block";
    submitBtn.style.display = "none";

    // details step
    if (currentIsDetails()){
      stepCard.innerHTML = `
        <div class="q">
          <h3>פרטים</h3>
          <p>רק כדי שנוכל לשמור תוצאה מסודרת</p>

          <label class="opt" style="cursor:default;">
            <span style="min-width:90px; color: var(--muted);">שם מלא</span>
            <input id="fullName" type="text" placeholder="שם מלא"
              value="${escapeHtml(fullName)}"
              style="flex:1; padding:10px; border-radius:12px; border:1px solid var(--line);
                     background:rgba(255,255,255,0.02); color:var(--text);"
            />
          </label>

          <label class="opt" style="cursor:default;">
            <span style="min-width:90px; color: var(--muted);">מגדר</span>
            <select id="gender"
              style="flex:1; padding:10px; border-radius:12px; border:1px solid var(--line);
                     background:rgba(255,255,255,0.02); color:var(--text);">
              <option value="">בחר/י</option>
              <option value="זכר" ${gender === "זכר" ? "selected" : ""}>זכר</option>
              <option value="נקבה" ${gender === "נקבה" ? "selected" : ""}>נקבה</option>
            </select>
          </label>

          <label class="opt" style="cursor:default;">
            <span style="min-width:90px; color: var(--muted);">אימייל</span>
            <input id="email" type="email" placeholder="name@email.com"
              value="${escapeHtml(email)}"
              style="flex:1; padding:10px; border-radius:12px; border:1px solid var(--line);
                     background:rgba(255,255,255,0.02); color:var(--text);"
            />
          </label>
        </div>
      `;

      // next disabled until required
      nextBtn.disabled = true;

      // hook inputs
      const fullNameEl = document.getElementById("fullName");
      const genderEl   = document.getElementById("gender");
      const emailEl    = document.getElementById("email");

      function sync(){
        fullName = fullNameEl.value.trim();
        gender   = genderEl.value;
        email    = emailEl.value.trim();
        nextBtn.disabled = !(fullName && gender);
      }

      fullNameEl.addEventListener("input", sync);
      genderEl.addEventListener("change", sync);
      emailEl.addEventListener("input", sync);
      sync();
      return;
    }

    // question step
    if (currentIsQuestion()){
      const qi = currentQIndex();
      const item = data[qi];

      stepCard.innerHTML = `
        <div class="q">
          <h3>שאלה ${qi + 1} מתוך 10</h3>
          <p>${escapeHtml(item.q)}</p>
          <div class="opts" id="opts"></div>
        </div>
      `;

      const optsEl = document.getElementById("opts");

      item.a.forEach((txt, j) => {
        const val = j + 1; // 1..4
        const selected = (answers[qi] === val);

        const label = document.createElement("label");
        label.className = "opt";
        label.innerHTML = `
          <input type="radio" name="q" value="${val}" ${selected ? "checked" : ""} />
          <span>${escapeHtml(txt)}</span>
        `;
        optsEl.appendChild(label);

        // auto-next on click (but still allow manual next/back)
        label.addEventListener("click", () => {
          answers[qi] = val;
          updateProgress();
          clearError();

          // מראה שהבחירה נקלטה + מעבר אוטומטי
          setTimeout(() => {
            if (isLastQuestionStep()){
              renderFinalButtons();
            } else {
              goToStep(stepIndex + 1);
            }
          }, 220);
        });
      });

      // prev enabled always here
      prevBtn.disabled = false;

      // next enabled only if answered current question
      nextBtn.disabled = (answers[qi] === null);

      // if already answered, keep next enabled
      // re-check on any change
      stepCard.addEventListener("change", (e) => {
        if (e.target && e.target.matches('input[type="radio"][name="q"]')) {
          answers[qi] = Number(e.target.value);
          updateProgress();
          nextBtn.disabled = false;
        }
      }, { once: true });

      // last step -> show submit instead of next
      if (isLastQuestionStep()){
        renderFinalButtons();
      }

      return;
    }

    // fallback (shouldn't happen)
    stepCard.innerHTML = "";
  }

  function renderFinalButtons(){
    nextBtn.style.display = "none";
    submitBtn.style.display = "inline-block";
    submitBtn.disabled = answeredCount() !== data.length;
  }

  // basic HTML escape (avoid breaking layout when user types)
  function escapeHtml(str){
    return String(str || "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  // ====== ACTIONS ======
  startBtn.addEventListener("click", () => {
    introScreen.style.display = "none";
    quizScreen.style.display = "block";
    goToStep(0); // details
  });

  prevBtn.addEventListener("click", () => {
    if (stepIndex > 0) goToStep(stepIndex - 1);
  });

  nextBtn.addEventListener("click", () => {
    clearError();

    // details validation
    if (currentIsDetails()){
      // sync current inputs
      const fullNameEl = document.getElementById("fullName");
      const genderEl   = document.getElementById("gender");
      const emailEl    = document.getElementById("email");
      fullName = (fullNameEl?.value || "").trim();
      gender   = (genderEl?.value || "");
      email    = (emailEl?.value || "").trim();

      if (!fullName || !gender){
        showError("חסר שם מלא או מגדר.");
        return;
      }

      goToStep(1); // first question
      return;
    }

    // question validation
    if (currentIsQuestion()){
      const qi = currentQIndex();
      if (answers[qi] === null){
        showError("בחר אופציה כדי להמשיך.");
        return;
      }

      if (isLastQuestionStep()){
        renderFinalButtons();
        return;
      }

      goToStep(stepIndex + 1);
      return;
    }
  });

  async function submitQuiz(){
    clearError();

    // validate details (in case user jumped back)
    if (!fullName || !gender){
      showError("חסר שם מלא או מגדר.");
      goToStep(0);
      return;
    }

    // validate answers
    for (let i = 0; i < data.length; i++){
      if (answers[i] === null){
        showError("חסרה לפחות תשובה אחת.");
        goToStep(i + 1); // question step
        return;
      }
    }

try{
  const overlay = document.getElementById("submitOverlay");
  if (overlay) overlay.style.display = "flex";

  submitBtn.disabled = true;
  prevBtn.disabled = true;
  nextBtn.disabled = true;

  const res = await fetch("/api/submit", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ answers, fullName, gender, email })
  });

  const dataRes = await res.json();
  const params = new URLSearchParams({ type: dataRes.type });

  window.location.href = `/result.html?${params.toString()}`;

} catch (e){
  showError("משהו השתבש בשליחה. נסה שוב.");
  const overlay = document.getElementById("submitOverlay");
  if (overlay) overlay.style.display = "none";
  submitBtn.disabled = false;
  prevBtn.disabled = false;
  nextBtn.disabled = false;
}


  }

  submitBtn.addEventListener("click", submitQuiz);

  // init ui
  updateProgress();
</script>
</body>
</html>
